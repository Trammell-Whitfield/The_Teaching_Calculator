<svg viewBox="0 0 900 650" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="white">
    INA219 Power Monitoring Circuit
  </text>
  <text x="450" y="50" text-anchor="middle" font-size="14" fill="white">
    ESP32 measuring Raspberry Pi 5 power consumption
  </text>
  
  <!-- Power Source -->
  <rect x="50" y="150" width="100" height="80" fill="#ff6b6b" stroke="#c92a2a" stroke-width="2" rx="5"/>
  <text x="100" y="180" text-anchor="middle" font-weight="bold" fill="white">5V Power</text>
  <text x="100" y="200" text-anchor="middle" font-size="12" fill="white">Supply</text>
  <text x="100" y="218" text-anchor="middle" font-size="11" fill="white">USB-C or</text>
  <text x="100" y="233" text-anchor="middle" font-size="11" fill="white">wall adapter</text>
  
  <!-- Power lines from source with labels -->
  <line x1="150" y1="170" x2="220" y2="170" stroke="#e03131" stroke-width="3"/>
  <text x="185" y="160" text-anchor="middle" font-size="12" fill="white" font-weight="bold">+5V</text>
  <line x1="150" y1="210" x2="220" y2="210" stroke="#1971c2" stroke-width="3"/>
  <text x="185" y="235" text-anchor="middle" font-size="12" fill="white" font-weight="bold">GND</text>
  
  <!-- INA219 Module -->
  <rect x="220" y="140" width="140" height="100" fill="#4dabf7" stroke="#1971c2" stroke-width="2" rx="5"/>
  <text x="290" y="165" text-anchor="middle" font-weight="bold" font-size="16" fill="white">INA219</text>
  <text x="290" y="182" text-anchor="middle" font-size="12" fill="white">Power Monitor</text>
  
  <!-- INA219 pins with arrows pointing to them -->
  <!-- Power input side -->
  <circle cx="225" cy="170" r="4" fill="#e03131"/>
  <line x1="205" y1="165" x2="221" y2="168" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="180" y="168" font-size="11" fill="white" text-anchor="end">Vin+</text>
  
  <circle cx="225" cy="210" r="4" fill="#1971c2"/>
  <line x1="205" y1="215" x2="221" y2="212" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="180" y="218" font-size="11" fill="white" text-anchor="end">Vin-</text>
  
  <!-- Power output side -->
  <circle cx="355" cy="170" r="4" fill="#e03131"/>
  <line x1="359" y1="168" x2="375" y2="165" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="380" y="168" font-size="11" fill="white">V+</text>
  
  <circle cx="355" cy="210" r="4" fill="#1971c2"/>
  <line x1="359" y1="212" x2="375" y2="215" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="380" y="218" font-size="11" fill="white">V-</text>
  
  <!-- I2C pins with better spacing -->
  <circle cx="270" cy="235" r="4" fill="#2f9e44"/>
  <line x1="270" y1="239" x2="270" y2="255" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="270" y="268" font-size="11" fill="white" text-anchor="middle">SDA</text>
  
  <circle cx="310" cy="235" r="4" fill="#f59f00"/>
  <line x1="310" y1="239" x2="310" y2="255" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="310" y="268" font-size="11" fill="white" text-anchor="middle">SCL</text>
  
  <!-- Sensor power pins -->
  <circle cx="245" cy="235" r="4" fill="#e03131"/>
  <line x1="245" y1="239" x2="245" y2="255" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="245" y="268" font-size="11" fill="white" text-anchor="middle">VCC</text>
  
  <circle cx="220" cy="235" r="4" fill="#1971c2"/>
  <line x1="220" y1="239" x2="220" y2="255" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="220" y="268" font-size="11" fill="white" text-anchor="middle">GND</text>
  
  <!-- Power lines to Pi with labels -->
  <line x1="355" y1="170" x2="500" y2="170" stroke="#e03131" stroke-width="3"/>
  <text x="425" y="160" text-anchor="middle" font-size="12" fill="white" font-weight="bold">+5V</text>
  <line x1="355" y1="210" x2="500" y2="210" stroke="#1971c2" stroke-width="3"/>
  <text x="425" y="235" text-anchor="middle" font-size="12" fill="white" font-weight="bold">GND</text>
  
  <!-- Raspberry Pi 5 -->
  <rect x="500" y="140" width="150" height="100" fill="#c92a2a" stroke="#862e2e" stroke-width="2" rx="5"/>
  <text x="575" y="165" text-anchor="middle" font-weight="bold" font-size="16" fill="white">Raspberry Pi 5</text>
  <text x="575" y="185" text-anchor="middle" font-size="12" fill="white">16GB RAM</text>
  <text x="575" y="205" text-anchor="middle" font-size="11" fill="white">Running LLM</text>
  <text x="575" y="222" text-anchor="middle" font-size="11" fill="white">SymPy + Wolfram</text>
  
  <!-- Pi power input -->
  <circle cx="505" cy="170" r="4" fill="#e03131"/>
  <circle cx="505" cy="210" r="4" fill="#1971c2"/>
  
  <!-- ESP32 -->
  <rect x="180" y="370" width="160" height="140" fill="#37b24d" stroke="#2b8a3e" stroke-width="2" rx="5"/>
  <text x="260" y="395" text-anchor="middle" font-weight="bold" font-size="16" fill="white">ESP32</text>
  <text x="260" y="415" text-anchor="middle" font-size="12" fill="white">Microcontroller</text>
  <text x="260" y="435" text-anchor="middle" font-size="11" fill="white">Reads INA219</text>
  <text x="260" y="452" text-anchor="middle" font-size="11" fill="white">via I2C</text>
  <text x="260" y="472" text-anchor="middle" font-size="12" fill="white" font-weight="bold">Calculates P = V × I</text>
  <text x="260" y="492" text-anchor="middle" font-size="10" fill="white">(e.g., 5V × 1.82A = 9.1W)</text>
  
  <!-- ESP32 pins with MUCH better spacing using side labels -->
  <circle cx="215" cy="375" r="4" fill="#e03131"/>
  <line x1="215" y1="371" x2="215" y2="355" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="215" y="348" font-size="11" fill="white" text-anchor="middle">5V</text>
  
  <circle cx="185" cy="375" r="4" fill="#1971c2"/>
  <line x1="185" y1="371" x2="185" y2="355" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="185" y="348" font-size="11" fill="white" text-anchor="middle">GND</text>
  
  <!-- GPIO21 with side label -->
  <circle cx="270" cy="375" r="4" fill="#2f9e44"/>
  <line x1="266" y1="375" x2="230" y2="375" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="155" y="368" font-size="11" fill="white" text-anchor="middle" font-weight="bold">GPIO21</text>
  <text x="155" y="383" font-size="9" fill="white" text-anchor="middle">(SDA)</text>
  
  <!-- GPIO22 with side label on opposite side -->
  <circle cx="310" cy="375" r="4" fill="#f59f00"/>
  <line x1="314" y1="375" x2="350" y2="375" stroke="white" stroke-width="1" marker-end="url(#arrowwhite)"/>
  <text x="365" y="368" font-size="11" fill="white" text-anchor="middle" font-weight="bold">GPIO22</text>
  <text x="365" y="383" font-size="9" fill="white" text-anchor="middle">(SCL)</text>
  
  <!-- I2C connections with labels positioned better -->
  <line x1="270" y1="268" x2="270" y2="375" stroke="#2f9e44" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="250" y="315" font-size="11" fill="white" font-weight="bold">SDA</text>
  
  <line x1="310" y1="268" x2="310" y2="375" stroke="#f59f00" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="330" y="315" font-size="11" fill="white" font-weight="bold">SCL</text>
  
  <!-- Power connections for INA219 sensor chip -->
  <line x1="220" y1="268" x2="220" y2="320" stroke="#1971c2" stroke-width="2"/>
  <line x1="220" y1="320" x2="185" y2="375" stroke="#1971c2" stroke-width="2"/>
  
  <line x1="245" y1="268" x2="245" y2="320" stroke="#e03131" stroke-width="2"/>
  <line x1="245" y1="320" x2="215" y2="375" stroke="#e03131" stroke-width="2"/>
  
  <!-- USB power to ESP32 -->
  <rect x="450" y="400" width="100" height="70" fill="#868e96" stroke="#495057" stroke-width="2" rx="5"/>
  <text x="500" y="425" text-anchor="middle" font-size="13" fill="white" font-weight="bold">USB</text>
  <text x="500" y="443" text-anchor="middle" font-size="13" fill="white" font-weight="bold">Power</text>
  <text x="500" y="460" text-anchor="middle" font-size="10" fill="white">for ESP32</text>
  
  <line x1="450" y1="420" x2="340" y2="420" stroke="#e03131" stroke-width="2" stroke-dasharray="3,3"/>
  <line x1="450" y1="445" x2="340" y2="445" stroke="#1971c2" stroke-width="2" stroke-dasharray="3,3"/>
  
  <!-- Annotations box -->
  <rect x="40" y="540" width="820" height="95" fill="#2c2c2c" stroke="#444" stroke-width="2" rx="5"/>
  <text x="60" y="565" font-size="13" font-weight="bold" fill="white">How it works:</text>
  <text x="60" y="585" font-size="12" fill="white">1. Power flows through INA219 (Vin+ → V+) to measure current in series</text>
  <text x="60" y="605" font-size="12" fill="white">2. INA219 measures voltage drop across shunt resistor + bus voltage</text>
  <text x="60" y="625" font-size="12" fill="white">3. ESP32 reads voltage &amp; current via I2C, then calculates Power = V × I (e.g., 5V × 1.82A = 9.1W)</text>
  
  <!-- Legend with better spacing -->
  <rect x="680" y="280" width="200" height="130" fill="#2c2c2c" stroke="#444" stroke-width="2" rx="5"/>
  <text x="700" y="305" font-size="12" font-weight="bold" fill="white">Signal Types:</text>
  
  <line x1="700" y1="320" x2="740" y2="320" stroke="#e03131" stroke-width="3"/>
  <text x="750" y="325" font-size="11" fill="white">Power (+5V)</text>
  
  <line x1="700" y1="340" x2="740" y2="340" stroke="#1971c2" stroke-width="3"/>
  <text x="750" y="345" font-size="11" fill="white">Ground (GND)</text>
  
  <line x1="700" y1="360" x2="740" y2="360" stroke="#2f9e44" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="750" y="365" font-size="11" fill="white">I2C Data (SDA)</text>
  
  <line x1="700" y1="380" x2="740" y2="380" stroke="#f59f00" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="750" y="385" font-size="11" fill="white">I2C Clock (SCL)</text>
  
  <!-- Current flow annotation with arrow -->
  <path d="M 180 260 Q 290 300 400 260" fill="none" stroke="#fa5252" stroke-width="2" marker-end="url(#arrowred)"/>
  <text x="290" y="320" text-anchor="middle" font-size="12" fill="white" font-weight="bold">Current measured here</text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowred" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#fa5252"/>
    </marker>
    <marker id="arrowwhite" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L7,3 z" fill="white"/>
    </marker>
  </defs>
</svg>